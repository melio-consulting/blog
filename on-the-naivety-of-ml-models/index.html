<!DOCTYPE html>
<html lang="en-us"><head>
	
	
	
	
	<html class="no-js" lang="">
	
	<script src="https://kit.fontawesome.com/80436e7b44.js" crossorigin="anonymous"></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.99.0" />
	
	<title>The naivety of ML models and avoiding the naive trap</title>

	
	

	<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://blog.melio.ai/on-the-naivety-of-ml-models/cover.jpg"/>
<meta name="twitter:title" content="The naivety of ML models and avoiding the naive trap"/>
<meta name="twitter:description" content="When machine learning models learn to be dumb."/>

	<meta property="og:title" content="The naivety of ML models and avoiding the naive trap" />
<meta property="og:description" content="When machine learning models learn to be dumb." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.melio.ai/on-the-naivety-of-ml-models/" /><meta property="og:image" content="https://blog.melio.ai/on-the-naivety-of-ml-models/cover.jpg"/><meta property="article:section" content="" />
<meta property="article:published_time" content="2022-05-25T00:00:00+02:00" />
<meta property="article:modified_time" content="2022-05-25T00:00:00+02:00" />



	
	<link rel="icon" type="image/x-icon" href="/images/favicon.ico">

	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"
		integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i"
		rel="stylesheet">
	<link href="/css/medium.css" rel="stylesheet">
	<link href="/css/additional.css" rel="stylesheet">

	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<link href="/css/main.css" rel="stylesheet">
	

	
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-488W4K7EG7"></script>
	<script>
		window.dataLayer = window.dataLayer || [];

		function gtag() {
			dataLayer.push(arguments);
		}
		gtag('js', new Date());

		gtag('config', 'G-488W4K7EG7');
	</script>
</head><body>
<nav class="navbar navbar-expand-lg navbar-dark sticky-top" style="background-color: #154c57; min-height: 80px;" data-home="true" role="navigation">
    <div class="container">
        <a class="navbar-brand" href="/" style="height: 80px; line-height: 80px; padding: 0;"><img src="/images/logo-long-dark.png" alt="logo" data-rjs="2"></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
            <ul class="navbar-nav ml-auto mt-2 mt-lg-0 text-center">
                <li class="nav-item pl-3">
                    <a class="nav-link" href="https://melio.ai/#what-we-do">What We Do </a>
                </li>
                <li class="nav-item dropdown pl-3"><a href="#" class="nav-link dropdown-toggle" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Offerings</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" style="background-color: rgba(255, 255, 255, 0.80);">
                        <a class="dropdown-item" href="https://melio.ai/how">Consulting</a>
                        <a class="dropdown-item" href="https://melio.ai/training">Training</a>
                    </div>
                </li>
                <li class="nav-item dropdown pl-3"><a href="#" class="nav-link dropdown-toggle" id="navbarDropdownMenuLinkCommunity" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Contributions</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLinkCommunity" style="background-color: rgba(255, 255, 255, 0.80);">
                        <a class="dropdown-item" href="https://melio.ai/events">Events</a>
                        <a class="dropdown-item" href="https://github.com/melio-consulting">Open Source</a>
                    </div>
                </li>
                <li class="nav-item pl-3">
                    <a class="nav-link" href="https://melio.ai/#who-we-are">Our Team</a>
                </li>
                <li class="nav-item pl-3">
                    <a class="nav-link" href="/">Blog</a>
                </li>
                <li class="nav-item pl-3">
                    <a class="nav-link" href="https://melio.ai/#contact-us">Contact Us</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

        <div class="site-content">   
            <div class="container">
    
    <div class="main-content">
        
        <div class="container">
            <div class="row">
                
                <div class="col-md-2 pl-0"><div class="share sticky-top sticky-top-offset">
    <p>Share</p>
    <ul>
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://twitter.com/intent/tweet?text=The%20naivety%20of%20ML%20models%20and%20avoiding%20the%20naive%20trap&url=https%3a%2f%2fblog.melio.ai%2fon-the-naivety-of-ml-models%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=435');return false;">
        <i class="fab fa-twitter"></i>
        </a>
        </li>

        <li class="ml-1 mr-1">
        <a target="_blank" href="https://facebook.com/sharer.php?u=https%3a%2f%2fblog.melio.ai%2fon-the-naivety-of-ml-models%2f" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
        <i class="fab fa-facebook-f"></i>
        </a>
        </li>

    </ul>

    
</div>
</div>
                
                <div class="col-md-9 flex-first flex-md-unordered">
                    <div class="mainheading">
                        
                        <div class="row post-top-meta">
                            <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left md-nopad-left">
                                <span class="author-description">
                                    <i class="far fa-star"></i>
                                    May 25, 2022
                                    <i class="far fa-clock clock"></i>
                                    7 min read
                                </span>
                            </div>
                        </div>
                        
                        <h1 class="posttitle">The naivety of ML models and avoiding the naive trap</h1>
                    </div>

                    
                    
                    
                        
                    
                    

                    
                    <div class="article-post">
                        <blockquote>
<p>When machine learning models learn to be dumb.</p>
</blockquote>

<figure >
    
        <img class="center" src="cover.jpg"  />
    
    
    <figcaption>
        <h6>Photo by pch.vector from Freepik.</h6>
        
    </figcaption>
    
</figure>

<h1 id="the-naivetrap">The naive trap</h1>
<p>You need a competitive edge when forecasting stock price movements.  Therefore, you want your fancy machine learning (ML) models to learn something useful from the provided data that humans might not be aware of. This article will show you examples of where those fancy ML models learn something dumb that looks intelligent and how to check if your models are doing the same.</p>
<p>I came across this problem when comparing the stock forecasting performance of various ML models. After selecting the top-performing models, I made a quick comparison to a Naive benchmark model as a sanity check (the Naive model just uses the current price as a forecast for the next time step so it&rsquo;s not an &ldquo;intelligent&rdquo; model that learns anything from historical data). After some investigation, I found that some of these ML models learned the Naive forecasting strategy, which left me with a couple of fancy-looking models that are no more useful than a toddler saying tomorrow&rsquo;s price will be the same as today&rsquo;s price. I fell into what I call the naive trap. Read on to learn how to avoid falling into the same trap.</p>
<h1 id="its-easy-to-foolyourself">It&rsquo;s easy to fool yourself</h1>
<blockquote>
<p>Insidious confirmation bias creeps in fast as we spot the first signs of success in our beautiful money-printing ML creations and we forget to apply a rigorous scientific approach.</p>
</blockquote>
<p>Most people get very excited to use ML. Using ML to solve problems is often romanticised (I&rsquo;m also guilty here). There is a unique thrill accompanying the sight of a computer beating a human at some task: it simultaneously gives you a slight existential shake, making you wonder about your long-term relevance, while also satisfying your inner math geek and giving you a feeling similar to watching the first human landing on the moon. Because of this, we want our ML models to succeed. Insidious confirmation bias creeps in fast as we spot the first signs of success in our beautiful money-printing ML creations and we forget to apply a rigorous scientific approach. Consider the following example to see just how easy this can happen.</p>
<h1 id="an-example">An example</h1>
<h2 id="overview-setting-thestage">Overview: setting the stage</h2>
<p>In this example, I considered forecasting the next day&rsquo;s price of Apple stock. I compared the performance of the following models (selected arbitrarily for illustration, feel free to plug in your own and rerun the analysis):</p>
<ul>
<li>Linear regression</li>
<li>Random forest</li>
<li>Multi-layer perceptron (MLP)</li>
<li>Naive</li>
</ul>
<p>A summary of the analysis is given below (the full analysis can be found in <a href="https://github.com/ruankie/naive-ml">this GitHub repo</a>).</p>
<h2 id="details-data-processing-and-setting-the-targetvariable">Details: Data processing and setting the target variable</h2>
<p>Firstly, the raw historical data was retrieved from Yahoo Finance. For data processing, some technical indicators were added as part of feature engineering. These features contain momentum, trend, volume, and volatility information and are commonly used as features in stock price forecasting. The data set features were also standardised so they were on a similar scale and appropriate for training ML models.</p>
<p>The data set was split into a training and a testing portion. As seen in the figure below, training was done on data from <em>2018–01–01 to 2021–05–31</em> (41 months) and testing was done on data from <em>2021–06–01 to 2021–12–01</em> (6 months).</p>

<figure >
    
        <img class="center" src="figures/train-test-AAPL.png"  />
    
    
    <figcaption>
        <h6>Price evolution of Apple stock during the train and test period (image by author)</h6>
        
    </figcaption>
    
</figure>

<p>In this supervised ML setting, the target was specified as the next day&rsquo;s return. A price forecast can be reconstructed from the returns forecast. To do this, first, consider the definition of returns rₜ₊₁ at time <em>t+1</em>:</p>
<figure >
        <img class="center" src="equations/return_eq@2x.png" style="width: 202px; min-width: ;" />
</figure>
<p>Where pₜ₊₁ is the price at time <em>t+1</em> and pₜ is the price at time <em>t</em>. This can be rearranged to get an expression for the next day&rsquo;s price:</p>
<figure >
        <img class="center" src="equations/price_from_ret@2x.png" style="width: 240px; min-width: ;" />
</figure>
<p>After training the above-mentioned ML models, their performance was assessed on the test set using the root mean squared error (<em>RMSE</em>):</p>
<figure >
        <img class="center" src="equations/rmse@2x.png" style="width: 451px; min-width: ;" />
</figure>
<p>where <em>r</em> and r̂ are the actual and forecasted returns of the training set respectively, each containing <em>N</em> elements (the number of days in the test set). Because returns are used here, the result can be interpreted as a percentage price forecast error. The figure below shows the <em>RMSE</em> obtained by each model (lower is better).</p>
<h2 id="results-first-appearances-are-deceiving">Results: First appearances are deceiving</h2>

<figure >
    
        <img class="center" src="figures/errors-AAPL.png"  />
    
    
    <figcaption>
        <h6>Root mean squared error (RMSE) of forecasts produced by models on the test set (image by author)</h6>
        
    </figcaption>
    
</figure>

<p>Notice that the errors of the Linear model and the Random Forest model are very close to that of the Naive model. At this point, you might be tempted to choose the Linear model as your top performer and happily put it into production, proudly claiming it makes just over a 1.2% error in price forecasts. However, when considering the strategy it learned to produce these forecasts, you might reconsider. Have a look at the following plot of return forecasts to see why this is the case.</p>
<h2 id="results-a-closer-look-at-what-waslearned">Results: A closer look at what was learned</h2>

<figure >
    
        <img class="center" src="figures/return-forecast-AAPL.png"  />
    
    
    <figcaption>
        <h6>Return forecast produced by models on the test set (image by author)</h6>
        
    </figcaption>
    
</figure>

<p>A quick inspection reveals that the return forecast for the Linear model was almost always 0.0. This is the same as saying there will be no price difference between today&rsquo;s price and tomorrow&rsquo;s price. If this rings a bell, well done spotting it! This is of course the Naive forecasting strategy. It is also interesting to see the similarity between the Random Forest&rsquo;s return forecast and the Naive model&rsquo;s. Even though it is not as similar as the Linear model, it still very closely resembles the Naive strategy. These return forecasts can be converted into price forecasts as shown above to reveal a more intuitive and familiar plot:</p>

<figure >
    
        <img class="center" src="figures/price-forecast-AAPL.png"  />
    
    
    <figcaption>
        <h6>Price forecast produced by models on the test set. The close price is also shown (image by author)</h6>
        
    </figcaption>
    
</figure>

<p>This is a plot that more people will be familiar with. However, looking at this price forecast, it is not that obvious that the Linear and Random Forest models basically learned the Naive strategy. It is again easy to fall into the trap and conclude that the Linear model is a great solution.</p>
<h1 id="a-recipe-for-avoiding-the-naivetrap">A recipe for avoiding the naive trap</h1>
<p>This is a great example of why data scientists shouldn&rsquo;t blindly chase a technical metric to optimise. As you have seen, from that point of view, you can easily end up with &ldquo;solutions&rdquo; that are not very useful. Instead, consider the bigger picture when deciding what would constitute a solution to a given problem. This might mean further interrogating candidate solutions to see if they stand up to constraints not imposed by the original optimisation metric. In the case of stock price forecasting, consider adding the following steps to your process of finding a solution to avoid the naive trap:</p>
<ol>
<li>Have a look at the returns forecast</li>
<li>Check how similar your ML models are to the Naive strategy (0.0 returns forecast)</li>
<li>Consider eliminating Naive-like models from your list of top-performers</li>
</ol>
<h1 id="conclusion">Conclusion</h1>
<p>In conclusion, this article shows you how to avoid the trap of misinterpreting low price forecast errors and falling in love with your ML models before properly interrogating them. In the case of stock price forecasting, make sure that your complex ML models don&rsquo;t learn something of little use like the Naive strategy after optimising for your preferred error metric.
Simply plotting the return forecasts can give you valuable insight into this particular problem. Have a look at <a href="https://github.com/ruankie/naive-ml">this GitHub repo</a> for more details on the specifics of this analysis or to get you up and running with the same analysis quickly if you want to plug in your own models.
Remember to always compare your ML models to simple benchmark models and happy forecasting!</p>
<p><em><strong>Disclaimer:</strong></em> <em>The information and content provided herein are meant for illustration purposes only. It is not intended for nor does it constitute financial, tax, investment, or other advice. Before making any decision or taking any action regarding your finances, you should consult a qualified Financial Adviser.</em></p>
<h1 id="resources">Resources</h1>
<ol>
<li><a href="https://finance.yahoo.com/quote/AAPL/">Yahoo Finance</a> for market data</li>
<li><a href="https://github.com/ranaroussi/yfinance">yfinance library</a> for market data</li>
<li><a href="https://github.com/bukosabino/ta">ta library</a> for technical indicators</li>
<li><a href="https://scikit-learn.org/stable/supervised_learning.html">scikit-learn library</a> for ML models</li>
<li>Republished here with permission from the <a href="https://medium.com/@ruankie/on-the-naivety-of-ml-models-and-how-to-avoid-the-naive-trap-aca90f5924e0">original post</a> on <a href="https://medium.com/@ruankie">Medium</a></li>
</ol>

<div class="pdivider " ><p>. . .</p>
</div>

<!-- raw HTML omitted -->

                    </div>

                    
                    <div class="after-post-tags">
                        <ul class="tags">
                        
                        <li>
                        <a href="/tags/medium">medium</a>
                        </li>
                        
                        <li>
                        <a href="/tags/data-science">data science</a>
                        </li>
                        
                        <li>
                        <a href="/tags/machine-learning">machine learning</a>
                        </li>
                        
                        <li>
                        <a href="/tags/equities">equities</a>
                        </li>
                        
                        <li>
                        <a href="/tags/forecasting">forecasting</a>
                        </li>
                        
                        <li>
                        <a href="/tags/time-series">time series</a>
                        </li>
                        
                        </ul>
                    </div>
                    

                    
                    <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
                    
                    
                        <a class="d-block col-md-6 text-lg-right" href="https://blog.melio.ai/whats-so-modern-about-mds/">What&#39;s so modern about the modern data stack? &raquo;</a>
                    
                    <div class="clearfix"></div>
                    </div>
                    
                </div>
                
            </div>
        </div>
        
        
    </div>


            </div>
<div>
	<p style="margin-bottom:3cm;"> </p>
</div>
<footer class="footer">
    <div class="footer-top">
        <div class="container">
            <div class="row">
                <div class="footer-col col-md-1"></div>
                <div class="footer-col col-md-4">
                    <h5>Contact Us</h5>
                    <p>info@melio.ai</p>
                </div>
                <div class="footer-col col-md-2">
                </div>
                <div class="footer-col col-md-4">
                    <h5>About Melio Consulting</h5>
                    <p>We specialise in developing and deploying machine learning solutions in the cloud. Melio has experience across financial, telecommunications and entertainment industries.</p>
                </div>
                <div class="footer-col col-md-1"></div>
            </div>
        </div>
    </div>
    <div class="footer-bottom">
        <div class="container">
            <div class="col-md-12">
                <p>Copyright © 2022 Melio Consulting (Pty) Ltd </br> All Rights Reserved<br>
                </p>
            </div>
        </div>
    </div>
</footer>

        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<script src="/js/mediumish.js"></script>

    </body>
</html>
